<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Biostatistical Basics: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><abbr class="icon" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="text-decoration: unset">
           
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #383838">Pre-Alpha
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="color: #FF4955; border-radius: 5px"></i>
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Biostatistical Basics
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Biostatistical Basics
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Biostatistical Basics
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-sampling.html">1. What is sampling</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-distributions.html">2. What is a probability distribution?</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-binomial.html">3. The binomial distribution</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-distributions-R.html">4. Probability distributions in R</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-Poisson.html">5. The Poisson distribution</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-simulations.html">6. Simulations in R</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-gamma-poisson.html">7. The Gamma-Poisson distribution</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-gaussian.html">8. The Gaussian distribution</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-visualizing-distributions.html">9. Visualizing distributions</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-histogram.html">10. Histograms in R</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-cdf.html">11. The cumulative distribution function</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="12-qq.html">12. The QQ-plot</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="13-summary.html">13. Summary</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="14-exercises.html">14. Exercises</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-sampling"><p>Content from <a href="01-sampling.html">What is sampling</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/01-sampling.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 5 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is sampling?<br>
</li>
<li>What requirements should a good sample fulfill?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Introduce the concept of sampling.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<figure><img src="../fig/sampling-frogs.png" alt="lake with frogs and two samples drawn from them" width="500" class="figure mx-auto d-block"><figcaption>Sampling frogs in a lake</figcaption></figure><p>Let’s start with an example, and thereby define some terminology. We
have a lake with frogs in it, and there are light and dark green frogs.
There’s a sunny side of the lake, and a shadowy area by the trees. Now
imagine you want to estimate the fraction of light green frogs in the
lake. There are too many frogs to count them all, so you catch a few and
count how many of them are light coloured. This is a sample. A
<strong>sample</strong> are randomly independently drawn events from a
<strong>population of interest</strong>. The population of interest, in
this case, are all the frogs in that lake. How can we draw
<strong>randomly and independently</strong>? One obvious thing you could
randomize in this experiment is the location at which you cath the
frogs, because from the above picture you could get the impression that
light-coloured frogs gather more in the shadows, while the dark-green
frogs like the sun. Therefore, if we caught all the frogs in the same
area, like in sample 1, this would probably over-represent light frogs,
thus not representing the population well. When randomizing the
locations, this is less likely to be the case (see for example sample
2). You get similar problems if the observations are not independent.
One example of dependent observations would be if you start with one
frog, then catch the one right next to it, and so on. This is also
likely to over-represent one colour of frogs, and the reason why
observations shouldn’t depend on each other. The <strong>sample
size</strong> is the number of frogs in one sample.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>
  Instructor Note
  </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>Inline instructor notes can help inform instructors of timing
challenges associated with the lessons. They appear in the “Instructor
View”</p>
</div>
</div>
</div>
</div></section><section id="aio-02-distributions"><p>Content from <a href="02-distributions.html">What is a probability distribution?</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/02-distributions.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 12 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a probability distribution?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe how a probability distribution maps outcomes to
probabilities</li>
<li>Explain the difference between discrete and continuous
distributions</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="overview-probability-distributions"><h2 class="section-heading">Overview probability distributions<a class="anchor" aria-label="anchor" href="#overview-probability-distributions"></a>
</h2>
<hr class="half-width">
<p>Most data analyses assume that data comes from some distribution. A
probability distribution assigns probabilities to possible outcomes of
an experiment. In terms of sampling, even if the sampling is supposed to
be random, it doesn’t mean that there are no rules – so one could say
that the probability distribution defines the rules for randomness.</p>
<p>Let’s get back to our example of the lake of frogs, which is
inhabited by light and dark green frogs. Let’s say, the true fraction of
light green frogs is <span class="math inline">\(1/3\)</span>, and you
decide sample of <span class="math inline">\(n=10\)</span> frogs from
that lake at random. Then, if you count the number of light-colored
frogs within that net, there are 11 possible outcomes: The number can be
between 0 and 10.</p>
<p>Below, you see a plot out of this, where each of these events has a
probability. A suitable distribution for describing this scenario is the
<em>binomial distribution</em>, which assumes a number of trials (frog
catches) which can have two outcomes (light, dark).</p>
<figure><img src="../fig/sampling-frogs-2.png" alt="possible outcomes of sampling ten frogs" width="500" class="figure mx-auto d-block"><figcaption>Binomial sampling</figcaption></figure><p>If the true fraction of light frogs is one third, then the most
likely outcome is catching 3 light frogs. Seeing 10 light frogs is
rather unlikely: The probability is close to zero, and we would consider
this a rare event.</p>
<figure><img src="../fig/sampling-frogs-3.png" alt="graph showing probability distribution of frog catches" width="500" class="figure mx-auto d-block"><figcaption>Sampling probabilities</figcaption></figure><div id="challenge-which-of-the-following-statements-are-true" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-which-of-the-following-statements-are-true" class="callout-inner">
<h3 class="callout-title">Challenge: Which of the following statements
are true?<a class="anchor" aria-label="anchor" href="#challenge-which-of-the-following-statements-are-true"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>A probability distribution assigns probabilities to possible
outcomes of an experiment.<br>
</li>
<li>The probabilities in a statistical distribution sum/integrate up to
1.<br>
</li>
<li>If the experiments are not randomized, the results don’t follow a
statistical distribution.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Answers 1 and 2 are correct. To 3: If experiments are not randomized,
the results still follow some distribution, but they are likely to not
represent reality well.</p>
</div>
</div>
</div>
</div>
<figure><img src="../fig/distributions-1.png" alt="example graphs for discrete and continuous probability distributions" width="800" class="figure mx-auto d-block"><figcaption>Types of probability distributions</figcaption></figure></section><section id="discrete-and-continuous-distributions"><h2 class="section-heading">Discrete and continuous distributions<a class="anchor" aria-label="anchor" href="#discrete-and-continuous-distributions"></a>
</h2>
<hr class="half-width">
<p>There are two types of probability distributions: discrete and
continuous.</p>
<p>A <strong>discrete distribution</strong> is what we have just seen,
in this case the observations can only take integer values, in our
example the counts from 0 to 10. In between those values, the
probabilities are zero, that’s why it’s called a probability mass
function: The probability mass is on defined points.</p>
<p>In a <strong>continuous distribution</strong>, we have a probability
density function. An example is the Gaussian distribution. That would be
suitable if we measured the sizes of frogs, and they are well described
by a mean size and a variance. On a continuous scale, there are
infinitely many values, so that the probability for a specific value,
for example a frog size of exactly 9cm is zero. What makes sense instead
is to ask for the probability of an observation to fall into a certain
interval, for example between 8 and 10 cm, and we get this probability
from integrating over the probability density function.</p>
<div id="challenge-discrete-distributions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-discrete-distributions" class="callout-inner">
<h3 class="callout-title">Challenge: Discrete distributions<a class="anchor" aria-label="anchor" href="#challenge-discrete-distributions"></a>
</h3>
<div class="callout-content">
<p>What is the probability of an outcome of X=1.5 in a discrete
distribution?</p>
<ul>
<li>0</li>
<li>0.5</li>
<li>0.15</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>The value <span class="math inline">\(1.5\)</span> is not discrete,
and can therefore not occur in a discrete distribution. Its probability
is zero.</p>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-03-binomial"><p>Content from <a href="03-binomial.html">The binomial distribution</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/03-binomial.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 5 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the binomial distribution?<br>
</li>
<li>What kind of data is it used on?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how the binomial distribution describes outcomes of
counting.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The binomial distribution is what we have just seen in the example:
We use it when we have a fixed sample size and count the number of
“successes” in that sample. Examples are:</p>
<ul>
<li>how many locations in the genome carry a mutation</li>
<li>the number of cells within a sample that show a certain
phenotype</li>
<li>how many patients out of 100 have a certain disease</li>
<li>how many out of 10 frogs are light green</li>
</ul>
<figure><img src="../fig/sampling-frogs-2.png" alt="possible outcomes of sampling 10 frogs" width="500" class="figure mx-auto d-block"></figure><p>The binomial model has two parameters, which means the probabilities
for the individual outcomes depend on two things: - <span class="math inline">\(n\)</span> is the number of trials, or frogs, or
patients, and it’s fixed. - <span class="math inline">\(p\)</span> is
the success probability.</p>
<p>Then the probability of observing <span class="math inline">\(k\)</span> successes out of <span class="math inline">\(n\)</span> draws (for example <span class="math inline">\(k=4\)</span> light coloured frogs out of <span class="math inline">\(N=10\)</span>) can be described by this
formula:</p>
<p><span class="math display">\[P(X=k) = {n\choose
k}p^k(1-p)^k\]</span></p>
<p>You don’t have to remember this piece of math – it’s just to make the
point that you can calculate the probability of an event that is modeled
with the binomial distribution, if you know the success probability
<span class="math inline">\(p\)</span> and the number of trials <span class="math inline">\(n\)</span>, i.e. the parameters.</p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>In the binomial we just define a particular outcome as success, for
example a light-coloured frog, or a patient with disease, even though
that may not be a favourable outcome.</p>
</div>
</div>
</div>
<p>Here is what the distribution looks like for a success probability of
0.3 and a sample size of 10.</p>
<figure><img src="../fig/binomial.png" alt="example graph for binomial probability distribution" width="500" class="figure mx-auto d-block"><figcaption>The binomial distribution</figcaption></figure><p>The expected value of the binomial is <span class="math inline">\(n
\times p\)</span>, which is quite intuitive: If we catch 10 frogs and
the probability of being light-green is 0.3, then we expect to catch 3
light-green frogs on average.</p></section><section id="aio-04-distributions-R"><p>Content from <a href="04-distributions-R.html">Probability distributions in R</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/04-distributions-R.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 12 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I calculate probabilities in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Demonstrate and practice the use of the base R functions for
calculating probabilities.</li>
<li>Explain the concept of cumulative distribution.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Before we look at more distributions, let’s get some hands-on
experience in R!<br>
R knows a whole range of distributions: <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Distributions.html" class="external-link">Here</a>
is a list of them.</p>
<p>For each distribution, R has four different function calls: For the
binomial distribution, these all end with <code>binom</code>:<br>
- <code>dbinom</code>: density<br>
- <code>pbinom</code>: cumulative distribution function (percentage of
values smaller than)<br>
- <code>qbinom</code>: quantile function (inverse of cumulative
distribution)<br>
- <code>rbinom</code>: generates random numbers</p>
<p>The first letter specifies if we want to look at the density,
probability distribution/mass function, quantile or random numbers. The
suffix specifies the distribution.</p>
<p>The arguments depend on the distribution we are looking at, but
always include the parameters of that function.</p>
<section id="calculating-probabilities"><h2 class="section-heading">Calculating probabilities<a class="anchor" aria-label="anchor" href="#calculating-probabilities"></a>
</h2>
<hr class="half-width">
<p>Let’s use the example where we caught 10 frogs and count how many of
them are light-colored.</p>
<p align="center">
<img src="../fig/sampling-frogs-2.png" width="500" class="figure"></p>
<p>For known parameters, we can calculate the the chances of counting
exactly 5 light-colored frogs:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># number of frogs we catch</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fl">0.3</span> <span class="co"># true fraction of light frogs</span></span>
<span><span class="fu">dbinom</span><span class="op">(</span>x<span class="op">=</span><span class="fl">5</span>, size<span class="op">=</span><span class="va">n</span>, prob<span class="op">=</span><span class="va">p</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.1029193</code></pre>
</div>
<p>We can ask for the probability of catching at most 5 light frogs. In
this case, we need the cumulative probability distribution starting with
<code>p</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pbinom</span><span class="op">(</span>q<span class="op">=</span><span class="fl">5</span>, size<span class="op">=</span><span class="va">n</span>, prob<span class="op">=</span><span class="va">p</span><span class="op">)</span> <span class="co"># at most</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.952651</code></pre>
</div>
<p>Similarly, we can ask for the probability of catching more than 5
light frogs:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pbinom</span><span class="op">(</span>q<span class="op">=</span><span class="fl">5</span>, size<span class="op">=</span><span class="va">n</span>,prob<span class="op">=</span><span class="va">p</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># larger than</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.04734899</code></pre>
</div>
<p>Catching at least 5 light frogs is a rare event.</p>
<div id="challenge-disease-prevalence" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-disease-prevalence" class="callout-inner">
<h3 class="callout-title">Challenge: Disease prevalence<a class="anchor" aria-label="anchor" href="#challenge-disease-prevalence"></a>
</h3>
<div class="callout-content">
<p>There is a disease with a known prevalence of 4%. You have a group of
100 randomly selected persons. Use the above functions to calculate</p>
<ol style="list-style-type: decimal">
<li>the probability of seeing exactly 7 persons with the disease.<br>
</li>
<li>the probability of seeing <em>at least</em> 7 persons with the
disease.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Exactly 7 persons:</li>
</ol>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dbinom</span><span class="op">(</span>x<span class="op">=</span><span class="fl">7</span>,size<span class="op">=</span><span class="fl">100</span>,prob<span class="op">=</span><span class="fl">0.04</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.05888027</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>At least 7 persons:</li>
</ol>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pbinom</span><span class="op">(</span>q<span class="op">=</span><span class="fl">6</span>, size<span class="op">=</span><span class="fl">100</span>, prob<span class="op">=</span><span class="fl">0.04</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.1063923</code></pre>
</div>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-05-Poisson"><p>Content from <a href="05-Poisson.html">The Poisson distribution</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/05-Poisson.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 10 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the Poisson distribution?<br>
</li>
<li>What kind of data is it used on?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how the Poisson distribution is derived from the
binomial.<br>
</li>
<li>Learn to apply the Poisson distribution in R</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="a-special-case-of-the-binomial-distribution"><h2 class="section-heading">A special case of the binomial distribution<a class="anchor" aria-label="anchor" href="#a-special-case-of-the-binomial-distribution"></a>
</h2>
<hr class="half-width">
<p>There is an approximation for the binomial distribution which can
often be convenient, specifically if we have</p>
<ul>
<li>many trials (large <span class="math inline">\(n\)</span>) and<br>
</li>
<li>a small success probability <span class="math inline">\(p\)</span>.</li>
</ul>
<figure><img src="../fig/poisson-derivation.png" alt="frog cartoon demonstrating how the Poisson is derived from the Binomial distribution" width="700" class="figure mx-auto d-block"><figcaption>The Poisson distribution is a special case of the
binomial</figcaption></figure><p>An example:</p>
<ul>
<li>We now fill the net for 1h, which is for a fixed period of
time.</li>
<li>We catch about 100 frogs per hour, which means after an hour we have
about 100 frogs in the net, and <span class="math inline">\(n \approx
100\)</span>.<br>
</li>
<li>The fraction of light frogs is low, only 2 % (<span class="math inline">\(p=0.02\)</span>).<br>
</li>
<li>After filling the net, we count only the light ones.</li>
</ul>
<p>We can now ask how many light frogs we can expect to catch per hour.
This expected number is called <span class="math inline">\(\lambda\)</span>, and it’s given by<br><span class="math display">\[\lambda = n*p = 100 \cdot 0.02 =
2.\]</span></p>
<p>For the possible outcomes, we again just look at the number of light
frogs, we are not interested in the number of dark frogs, or how many
frogs we caught in total. In this scenario <strong>we have reduced the
parameters to just one, the rate lambda</strong>, which is the expected
number of frogs per hour. And the probabilities of the outcomes can be
approximated with a Poisson distribution.</p>
</section><section id="what-is-the-poisson-used-for"><h2 class="section-heading">What is the Poisson used for?<a class="anchor" aria-label="anchor" href="#what-is-the-poisson-used-for"></a>
</h2>
<hr class="half-width">
<p>Even though the Poisson is derived as an approximation of the
Binomial, we don’t necessarily need two categories of events to use it.
We can also use it to count events of a single category.</p>
<figure><img src="../fig/sampling-frogs.png" alt="lake with only one sort of frogs" width="350" class="figure mx-auto d-block"><figcaption>Poisson example</figcaption></figure><p>For example, consider a two lakes with frogs of only one colour. We
might want to compare the density of frogs in these lakes, which can be
done by comparing the Poisson rates. For this, we count frogs within
<span class="math inline">\(2 m^2\)</span> regions in both lakes. For
each individual lake, this counting process could be described by a
Poisson, with the rate giving the average number of frogs per <span class="math inline">\(2 m^2\)</span>.</p>
<p>In general, the poisson describes counting events over a fixed
domain, which can be a period of time, or a fixed space. We assume here
that events have an underlying rate, called lambda.</p>
<p>Examples:</p>
<ul>
<li>Counting frogs for an hour, or within a defined area of the
lake.<br>
</li>
<li>counting cells or particles in microscopy images within a fixed
volume</li>
<li>counting how many times something happens in the cell within a fixed
period of time.</li>
<li>Also mutations in the genome can be approximated by Poisson, because
the genome has many base pairs, and the fraction of mutated base pairs
is low.</li>
</ul></section><section id="properties-of-the-poisson-distribution"><h2 class="section-heading">Properties of the Poisson distribution<a class="anchor" aria-label="anchor" href="#properties-of-the-poisson-distribution"></a>
</h2>
<hr class="half-width">
<p>The distribution has only one parameter, the rate.</p>
<p>The probability for counting <span class="math inline">\(k\)</span>
events over whatever fixed domain you have chosen is</p>
<p><span class="math display">\[\large P(X=k) =
\frac{\color{purple}\lambda^k e^{-\color{purple}\lambda}}{k!}
.\]</span></p>
<p>In the next plot, Poisson distributions for different rates are
shown:</p>
<p align="center">
<img src="../fig/many_lambdas_plot.png" width="400" class="figure"></p>
<p>If we look at the shape of the distribution, we see that</p>
<ul>
<li>for low rates, it is clinched towards zero and has long tails
towards larger values.</li>
<li>for larger rates (for example a rate of <span class="math inline">\(10\)</span> shown here in purple) the shape looks
more and more like a Gaussian. Indeed, high-valued counts can often be
well described with a Gaussian as well.</li>
</ul>
<p>Another important feature of the Poisson is that its variance and
mean are the same, they are both lambda. This means in turn that we can
estimate lambda from the sample mean.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>We are in a diagnostic laboratory that gets blood samples from
incoming hospital patients and tests them for some disease. Which of
these experiments can be modeled with a Poisson distribution?</p>
<ol style="list-style-type: decimal">
<li>Counting the number of positive samples out of 50 samples that get
tested successively.<br>
</li>
<li>Counting the number of samples that test positive within an
hour.<br>
</li>
<li>Counting the number of samples that get tested within an hour.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>All of these scenarios can be modeled with a Poisson. Counting the
number of positive samples out of 50 is more suitable for a binomial
distribution, but can indeed be <em>approximated</em> by Poisson.</p>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-06-simulations"><p>Content from <a href="06-simulations.html">Simulations in R</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/06-simulations.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 7 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I make my own data in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn to use the random number generators in R to simulate
data.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Here’s a short interlude on random numbers in R, which you can use to
simulate your own data. This can be very useful to set up toy models and
see what the data or certain plots would look like in theory.</p>
<p>For example, we could simulate frog counts from 100 binomial
experiments, that is the counts of light colored frogs from filling a
net one hundred times:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">85</span><span class="op">)</span></span>
<span><span class="va">size</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># number of frogs per net</span></span>
<span><span class="va">prob</span> <span class="op">=</span> <span class="fl">0.3</span> <span class="co"># true percentage of light colored frogs</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># number of binomial experiments</span></span>
<span><span class="va">binomial_frog_counts</span> <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>, size<span class="op">=</span><span class="va">size</span>, prob<span class="op">=</span><span class="va">prob</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">binomial_frog_counts</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3 1 2 3 3 4</code></pre>
</div>
<p>Here, we used <code>set.seed()</code> for reproducibility: The seed
gives an initialization to the process of drawing random numbers. So any
time we run the same simulation with the same seed, we will get the same
random numbers. If we don’t set the seed, the random numbers will look
different each time we run the code.</p>
<div id="poisson-random-numbers" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="poisson-random-numbers" class="callout-inner">
<h3 class="callout-title">Poisson random numbers<a class="anchor" aria-label="anchor" href="#poisson-random-numbers"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Simulate 100 random frog counts with a Poisson rate of 4.</li>
<li>Calculate the mean of the frog count.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">81</span><span class="op">)</span></span>
<span><span class="co"># 1. simulation</span></span>
<span><span class="va">frog_counts</span> <span class="op">&lt;-</span><span class="fu">rpois</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. calculate the mean</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">frog_counts</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.955</code></pre>
</div>
</div>
</div>
</div>
</div></section><section id="aio-07-gamma-poisson"><p>Content from <a href="07-gamma-poisson.html">The Gamma-Poisson distribution</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/07-gamma-poisson.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 14 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the Gamma-Poisson distribution?<br>
</li>
<li>What kind of data is it used on?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the Gamma-Poisson distribution and how it compares to the
Poisson distribution.</li>
<li>Further practice the use of probabilities and random numbers in
R.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="the-gamma-poisson-distribution"><h2 class="section-heading">The Gamma Poisson distribution<a class="anchor" aria-label="anchor" href="#the-gamma-poisson-distribution"></a>
</h2>
<hr class="half-width">
<p>In biology we often have the problem that the Poisson doesn’t fit
very well, because the observed distribution is more spread out than
expected for Poisson, that means the variance is larger than the
mean.This is due to additional variation that we haven’t captured, or
that we cannot control for.</p>
<p align="center">
<img src="../fig/gamma-poisson.png" width="800" class="figure"></p>
<figure><img src="../fig/gamma-poisson.png" alt="plots demonstrating a mixture distribution from gamma and poisson" width="800" class="figure mx-auto d-block"><figcaption>The Gamma Poisson distribution</figcaption></figure><p>To stay with the frogs counts – but this time each individual frog
was caught from a different lake. And each lake has slightly different
properties that affect the rate at which we can catch frogs in it. There
might be more or less frogs in them, or better hiding places.</p>
<p>We can <strong>model</strong> this by saying that for each data
point, the rate lambda is drawn from a distribution, in this case a
gamma distribution. You don’t have to know anything about the gamma
distribution, just that it has a bell shape, and thus gives us some
average rate and a variance. What we then have is individual frog counts
that all come from a slightly different Poisson distribution, so that
the overall distribution will be more spread out than each single
Poisson.</p>
<p>We call this a <strong>gamma-poisson distribution</strong>. It’s a
poisson distribution where the rate <span class="math inline">\(\lambda\)</span> for each data point was drawn
from a gamma distribution. It has two parameters: the mean (average
rate), and a scale parameter, which indicates how much the lambdas are
spread.</p>
<p>Examples for usage:</p>
<ul>
<li>modelling gene expression data, because there is always biological
variation between the samples, and we cannot measure where exactly it
comes from</li>
<li>modelling cell counts that come from slightly different volumes, or
from different individuals.</li>
</ul>
<div class="section level3">
<h3 id="the-gamma-poisson-distribution-in-r">The Gamma Poisson distribution in R<a class="anchor" aria-label="anchor" href="#the-gamma-poisson-distribution-in-r"></a>
</h3>
<p>The Gamma Poisson distribution goes by two names: “Gamma Poisson” or
“negative binomial”. In R, its suffix is <code>nbinom</code>. To make
things more confusing, the Gamma Poisson can be <em>parametrized</em> in
different ways. This means, it is possible to describe the same
distribution with different combinations of parameters.<br>
Above, I introduced a parametrization with</p>
<ul>
<li>mean <span class="math inline">\(\mu\)</span> (the average Poisson
rate) and<br>
</li>
<li>scale <span class="math inline">\(\theta\)</span> (a measure for how
much the Poisson rate varies between individual counts),</li>
</ul>
<p>because I find it most intuitive. The argument <code>mu</code> in
<code>dnbinom</code> lets you define <span class="math inline">\(\mu\)</span>. The argument <code>size</code> is
the inverse of <span class="math inline">\(\theta\)</span>, that is for
a small <code>size</code> you will get a distribution with a large
overdispersion (=spread). For very large values of <code>size</code>,
the distribution will tend towards a Poisson distribution.</p>
<div id="note" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h3>
<div class="callout-content">
<p>Consult the “Details” in the help function
(<code>help(dnbinom)</code>) if you choose to parametrize in a different
way.</p>
</div>
</div>
</div>
<div id="compare-gamma-poisson-to-the-poisson-distribution" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="compare-gamma-poisson-to-the-poisson-distribution" class="callout-inner">
<h3 class="callout-title">Compare Gamma poisson to the Poisson
distribution<a class="anchor" aria-label="anchor" href="#compare-gamma-poisson-to-the-poisson-distribution"></a>
</h3>
<div class="callout-content">
<p>To demonstrate how the Gamma Poisson distribution differs from a
Poisson, let’s compare the means and variances.</p>
<ol style="list-style-type: decimal">
<li>Simulate 100 random frog counts with a Poisson rate of 4 then
calculate the mean.<br>
</li>
<li>Simulate 100 random frog counts with a Poisson rate of 4, then
calculate the variance using the function <code>var</code>.</li>
<li>Simulate 100 random frog counts from different lakes with a mean 4
and <code>size=2</code>, then calculate the mean.</li>
<li>Simulate 100 random frog counts from different lakes with a mean of
4 and <code>size=2</code>, then calculate the variance using the
function <code>var</code>.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="co"># 1. Calculate the mean of a Poisson distribution</span></span>
<span><span class="fu">rpois</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mean</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.13</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Calculate the variance</span></span>
<span><span class="fu">rpois</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">var</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.555152</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Gamma poisson mean</span></span>
<span><span class="fu">rnbinom</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mu<span class="op">=</span><span class="fl">4</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="fu">mean</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.14</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. Gamma poisson variance</span></span>
<span><span class="fu">rnbinom</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mu<span class="op">=</span><span class="fl">4</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">var</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 10.75747</code></pre>
</div>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></section><section id="aio-08-gaussian"><p>Content from <a href="08-gaussian.html">The Gaussian distribution</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/08-gaussian.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 2 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the Gaussian distribution and what kind of data is it used
on?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Refresh the Gaussian distribution.</li>
<li>Give examples what it is used on.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="the-gaussian-distribution"><h2 class="section-heading">The Gaussian distribution<a class="anchor" aria-label="anchor" href="#the-gaussian-distribution"></a>
</h2>
<hr class="half-width">
<p>We covered the Gaussian – also known as <em>Normal distribution</em>
earlier in this tutorial as an example, and you have most likely come
across it before.</p>
<p>It is applicable to repeated measurements of the same thing, for
example</p>
<ul>
<li>frog lengths,<br>
</li>
<li>temperatures or<br>
</li>
<li>pixel intensities.</li>
</ul>
<figure><img src="../fig/frog_sizes.png" alt="plot of Gaussian distribution" width="500" class="figure mx-auto d-block"><figcaption>Gaussian probability density function</figcaption></figure><p>The Gaussian distribution is continuous and has two parameters:</p>
<ul>
<li>the <em>mean</em>, which is estimated by the sample mean, and<br>
</li>
<li>the <em>variance</em>, which is estimated by the sample
variance.</li>
</ul>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 --></section></section><section id="aio-09-visualizing-distributions"><p>Content from <a href="09-visualizing-distributions.html">Visualizing distributions</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/09-visualizing-distributions.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 5 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I visualize the distribution of my data?</li>
<li>How can I find out whether my data is well described by a certain
probability distribution?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Introduce the histogram, ECDF and QQ-plot as tools for comparing an
empirical to a theoretical distribution.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="tools-for-visually-comparing-distributions"><h2 class="section-heading">Tools for visually comparing distributions<a class="anchor" aria-label="anchor" href="#tools-for-visually-comparing-distributions"></a>
</h2>
<hr class="half-width">
<p>Usually, we have some data and want to find the “right” distribution
for it. That means, we want to find a distribution that models the data
in a suitable way. The workflow should look something like this:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Fit your data to a distribution that you consider
plausible.</strong> We’ll see how to do this in R. The fit will give you
the best parameters for this distribution, given your data.<br>
</li>
<li>
<strong>Visually compare the theory to your data points.</strong>
The theory in this case is the fit you just obtained. In the
visualization, a good fit doesn’t show systematic deviations of the data
points from theory.<br>
</li>
<li>
<strong>Do the same with other plausible
distributions.</strong><br>
</li>
<li><strong>Decide which fit looks best to you.</strong></li>
</ol>
<p>In this episode, I’ll introduce the most common visualizations for
empirical distributions. In the following episodes, we’ll see how to
produce them in R.</p>
</section><section id="the-histogram"><h2 class="section-heading">The histogram<a class="anchor" aria-label="anchor" href="#the-histogram"></a>
</h2>
<hr class="half-width">
<figure><img src="../fig/histogram.png" alt="histogram plot" width="800" class="figure mx-auto d-block"></figure><p>Once we have fitted a distribution to the data, we can visually
compare the theory, that is the fitted distribution, to the actual data
and decide whether this is a good fit. One very common thing to look at
is the histogram. The more data points you have, the more it resembles
the underlying probability distribution. So we could look at this
histogram here and check whether it looks similar to the Gaussian shape,
shown in blue. A problem about this plot is that, as you might have
noticed already, a lot of distributions look roughly bell-shaped. And
often it’s difficult to tell subtle differences from a histogram.</p>
</section><section id="the-cumulative-distribution"><h2 class="section-heading">The cumulative distribution<a class="anchor" aria-label="anchor" href="#the-cumulative-distribution"></a>
</h2>
<hr class="half-width">
<p>This is why it is also useful to look at the cumulative distribution.
<strong>For every value <span class="math inline">\(k\)</span>, the
cumulative distribution gives the percentage of data points that have a
smaller value than this <span class="math inline">\(k\)</span>.</strong></p>
<figure><img src="../fig/histogram-cumulative.png" alt="histogram and ecdf plot" width="800" class="figure mx-auto d-block"></figure><p>In this case, you can look up a certain frog size, and the graph will
tell you what percentage of frogs is smaller than that. For example, if
we look up the size of 6 cm, the cumulative distribution tells us that
roughly 75% of the frogs in the sample are smaller than 6 cm. The
empirical cumulative distribution comes from the data, and one little
step for each data point. The theoretical distribution gives the
percentage of data points that you’d expect to be smaller than a certain
value, for the distribution that you are comparing to. In this graph,
it’s often easier to see systematic deviations from the expectation, for
example here the blue line is substantially steeper than the black line,
so maybe here we are comparing to a theoretical distribution with a too
low variance.</p>
</section><section id="the-qq-plot"><h2 class="section-heading">The QQ-plot<a class="anchor" aria-label="anchor" href="#the-qq-plot"></a>
</h2>
<hr class="half-width">
<p>Another useful plot is the QQ-plot. It’s very often used for checking
whether the data is normal, but it can also be used for comparing to
other distributions.</p>
<figure><img src="../fig/histogram-cumulative-qq.png" alt="histogram, ecdf, and qq plot" width="800" class="figure mx-auto d-block"></figure><p>Here, we plot sample quantiles against theoretical quantiles. The
25th quantile is the value <span class="math inline">\(k\)</span> at
which 25% of the data points are smaller then k. You can determine the
quantile for each data point, and compare it to theory, so each point in
this plot is a comparison between theory and data. The nice thing about
this plot is that when the theory and data match well, all points end up
on a straight line. And it’s easy for our eyes to decide whether
something is a straight line or not.</p>
<div id="a-note-on-fitting" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="a-note-on-fitting" class="callout-inner">
<h3 class="callout-title">A note on fitting<a class="anchor" aria-label="anchor" href="#a-note-on-fitting"></a>
</h3>
<div class="callout-content">
<p>When we say we “fit” a distribution, we are usually talking about the
<em>maximum likelihood approach</em>. This means we find the parameters
for which it is most likely to see the given data. This is an
optimization problem - and thus can be solved conveniently by the
computer. You might also hear people say they <em>minimize the
deviance</em> when they fit data, and this is just another term for
minimizing the distance between the line (theory) and the points (data).
The exact mathematical formula for the deviance to be minimized depends
on the type of distribution we are fitting to – for example, when
fitting a Gaussian distribution, we minimize the sum of squares. But no
worries: The tools for fitting that you’ll get to know in this tutorial
know their formulae :)</p>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-10-histogram"><p>Content from <a href="10-histogram.html">Histograms in R</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/10-histogram.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 15 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I plot a histogram of my data in R?</li>
<li>How can I compare my data to a distribution using histograms?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Give examples for and practice plotting histograms with
<code>ggplot</code> and <code>goodfit</code>.</li>
<li>Learn to interpret the results.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="start-with-some-data"><h2 class="section-heading">Start with some data<a class="anchor" aria-label="anchor" href="#start-with-some-data"></a>
</h2>
<hr class="half-width">
<p>For demonstration, let’s simulate frog counts and sizes with random
draws from a Poisson and a Gaussian distribution. This code should by
now look familiar to you:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">51</span><span class="op">)</span> <span class="co"># set a seed for reproducibility</span></span>
<span><span class="va">frog_counts</span> <span class="op">&lt;-</span><span class="fu">rpois</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">frog_sizes</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, mean <span class="op">=</span> <span class="fl">7</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">frog_counts_different_lakes</span> <span class="op">&lt;-</span> <span class="fu">rnbinom</span><span class="op">(</span>n<span class="op">=</span><span class="fl">200</span>, size<span class="op">=</span><span class="fl">2</span>, mu<span class="op">=</span><span class="fl">4</span><span class="op">)</span>  </span></code></pre>
</div>
</section><section id="plotting-a-histogram"><h2 class="section-heading">Plotting a histogram<a class="anchor" aria-label="anchor" href="#plotting-a-histogram"></a>
</h2>
<hr class="half-width">
<p>We can then use <code>ggplot2</code> to plot histograms from the
simulations. The histogram will have a shape that is specific for the
distribution:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data.frame</span><span class="op">(</span><span class="va">frog_counts</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">frog_counts</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/10-histogram-rendered-histograms-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-plot-your-first-histogram" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-plot-your-first-histogram" class="callout-inner">
<h3 class="callout-title">Exercise: Plot your first histogram<a class="anchor" aria-label="anchor" href="#exercise-plot-your-first-histogram"></a>
</h3>
<div class="callout-content">
<p>Start with the following set-up:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">51</span><span class="op">)</span> <span class="co"># set a seed for reproducibility</span></span>
<span><span class="va">frog_counts</span> <span class="op">&lt;-</span><span class="fu">rpois</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre>
</div>
<p>Note how I used <code>binwidth=1</code> for displaying the count
data. What happens if you don’t?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>An automatic bin-width of 30 is chosen. Decide for yourself whether
this gives you a good overview over your data. It’s often a good idea to
play around with the <code>binwidth</code> parameter.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="relation-between-histogram-and-distribution-function">Relation between histogram and distribution function<a class="anchor" aria-label="anchor" href="#relation-between-histogram-and-distribution-function"></a>
</h3>
<p>The theoretical distribution gives the expected frequency of the
random numbers.</p>
<p>For example for the Poisson frog counts, we can calculate the
expected frequency of the counts from 0 to 20:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span></span>
<span><span class="va">expected_freq</span> <span class="op">&lt;-</span> <span class="fu">dpois</span><span class="op">(</span><span class="va">counts</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">frog_counts</span><span class="op">)</span> </span></code></pre>
</div>
<p>Then we can plot the expected counts as a line on top of the
histogram:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data.frame</span><span class="op">(</span><span class="va">frog_counts</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">frog_counts</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="fu">data.frame</span><span class="op">(</span><span class="va">counts</span>,<span class="va">expected_freq</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">counts</span>,<span class="va">expected_freq</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/10-histogram-rendered-histogram-expected-freq-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="the-goodfit-function">The <code>goodfit</code> function<a class="anchor" aria-label="anchor" href="#the-goodfit-function"></a>
</h3>
<p>You might not want to code this plot every time you visually inspect
a fit. Luckily, there are convenient functions that do this for you.</p>
<p>The <code>goodfit</code> function from the <code>vcd</code> package
allows you to fit a sample to a discrete distribution of interest.<br>
Here, we fit the frog counts to a Poisson:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span></span>
<span><span class="va">my_fit</span> <span class="op">&lt;-</span> <span class="fu">goodfit</span><span class="op">(</span><span class="va">frog_counts</span>,<span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="va">my_fit</span><span class="op">$</span><span class="va">par</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$lambda
[1] 3.83</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">my_fit</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/10-histogram-rendered-goodfit-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This is how a good fit looks like: The bars all roughly stop at zero,
some above and some below, which is due to the sample’s randomness.</p>
<div id="exercise-fit-a-poisson-distribution" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-fit-a-poisson-distribution" class="callout-inner">
<h3 class="callout-title">Exercise: Fit a Poisson distribution<a class="anchor" aria-label="anchor" href="#exercise-fit-a-poisson-distribution"></a>
</h3>
<div class="callout-content">
<p>Start with the following set-up:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">51</span><span class="op">)</span> <span class="co"># set a seed for reproducibility</span></span>
<span><span class="va">frog_counts_different_lakes</span> <span class="op">&lt;-</span> <span class="fu">rnbinom</span><span class="op">(</span>n<span class="op">=</span><span class="fl">200</span>, size<span class="op">=</span><span class="fl">2</span>, mu<span class="op">=</span><span class="fl">4</span><span class="op">)</span>  </span></code></pre>
</div>
<p>Use the <code>goodfit</code> function to fit the
<code>frog_counts_different_lakes</code> data with a Poisson.</p>
</div>
</div>
</div>
<p>This histogram in the above challenge should show you that there is a
systematic problem: The bars at the periphery hang very low and those
around the peaks hang high. This indicates that the fit isn’t too
good.</p>
<div id="exercise-fit-a-gamma-poisson" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-fit-a-gamma-poisson" class="callout-inner">
<h3 class="callout-title">Exercise: Fit a Gamma-Poisson<a class="anchor" aria-label="anchor" href="#exercise-fit-a-gamma-poisson"></a>
</h3>
<div class="callout-content">
<p>Start with the following set-up:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">51</span><span class="op">)</span> <span class="co"># set a seed for reproducibility</span></span>
<span><span class="va">frog_counts_different_lakes</span> <span class="op">&lt;-</span> <span class="fu">rnbinom</span><span class="op">(</span>n<span class="op">=</span><span class="fl">200</span>, size<span class="op">=</span><span class="fl">2</span>, mu<span class="op">=</span><span class="fl">4</span><span class="op">)</span>  </span></code></pre>
</div>
<ol style="list-style-type: decimal">
<li>Fit the frog counts from different lakes with a Gamma-Poisson
distribution instead (hint: in the <code>goodfit</code> function, it is
called <code>nbinomial</code>).<br>
</li>
<li>Can you make out the visual difference between a good and a bad
fit?</li>
</ol>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></section><section id="aio-11-cdf"><p>Content from <a href="11-cdf.html">The cumulative distribution function</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/11-cdf.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 3 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the empirical cumulative distribution function?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Demonstrate the cumulative distribution function with an
example.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The cumulative distribution is the integral of the distribution, and
thus the empirical cumulative distribution is the integral of the
histogram. It gives you the percentage of values that are smaller than a
certain value.<br>
We can visualize it with <code>stat_ecdf</code> in
<code>ggplot2</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data.frame</span><span class="op">(</span><span class="va">frog_sizes</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">frog_sizes</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/11-cdf-rendered-ecdf-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>As for the histogram, you could calculate the expected values for the
cumulative distribution and add them to the plot:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">.5</span><span class="op">)</span></span>
<span><span class="va">theoretical_cdf</span> <span class="op">&lt;-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="va">sizes</span>, mean<span class="op">=</span><span class="fl">7</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">data.frame</span><span class="op">(</span><span class="va">frog_sizes</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">frog_sizes</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="fu">data.frame</span><span class="op">(</span><span class="va">sizes</span>,<span class="va">theoretical_cdf</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">sizes</span>, <span class="va">theoretical_cdf</span><span class="op">)</span>,colour<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/11-cdf-rendered-ecdf-cdf-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Off this plot you can read for a frog size of <span class="math inline">\(x\)</span> (e.g. 7cm), that about 50% of the
values are smaller than this value. So this is really just another way
to display the histogram.</p>
<div id="note" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h3>
<div class="callout-content">
<p>The procedure above was shown for demonstration purposes. We will not
practice overlaying empirical and theoretical distribution functions
with <code>ggplot</code>, because in the next episode, we’ll introduce a
tool that does the work for you.</p>
</div>
</div>
</div></section><section id="aio-12-qq"><p>Content from <a href="12-qq.html">The QQ-plot</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/12-qq.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 8 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the QQ-plot?</li>
<li>How can I create a QQ-plot of my data?</li>
<li>Why is it useful?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Demonstrate the calculation of quantiles in R.</li>
<li>Explain the QQ-plot.</li>
<li>Introduce functions to make a qq-plot in R.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="the-qq-plot"><h2 class="section-heading">The QQ-plot<a class="anchor" aria-label="anchor" href="#the-qq-plot"></a>
</h2>
<hr class="half-width">
<p>The qq-plot compares the quantiles of two distributions.</p>
<p>Quantiles are the inverse of the cumulative distribution, i.e., the
<code>qnorm</code> function is the inverse of <code>pnorm</code>:</p>
<p>You can use <code>pnorm</code> to ask for the probability of seeing a
value of <span class="math inline">\(-2\)</span> or smaller:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.1586553</code></pre>
</div>
<p>Then you can use <code>qnorm</code> to ask that is the value for
which 15% of the other values are smaller. Here, I demonstrate this by
plugging the result into the <code>pnorm</code> function into the
<code>qnorm</code> function:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qnorm</span><span class="op">(</span>p<span class="op">=</span> <span class="fu">pnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -2</code></pre>
</div>
<p>Let’s compare the quantiles of the simulated frog sizes to the
theoretical quantiles of a normal distribution. There are specialized
functions for qq-plots, so we don’t have to calculate the theoretical
values by hand:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data.frame</span><span class="op">(</span><span class="va">frog_sizes</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">frog_sizes</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_qq</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_qq_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-qq-rendered-qq-plot-normal-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>By default, the <code>geom_qq</code> function assumes that we compare
to a standard normal distribution.<br>
This fit doesn’t look too bad, although for low values the points stray
away from the line. This shouldn’t surprise you, because remember: The
normal distribution approximates the Poisson distribution (with which
the simulation was generated) well for large values, but has limitations
for low-valued counts.</p>
<p>Let’s set up a qq-plot where we compare to a Poisson
distribution:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data.frame</span><span class="op">(</span><span class="va">frog_counts</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">frog_counts</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_qq</span><span class="op">(</span>distribution<span class="op">=</span><span class="va">qpois</span>, dparams<span class="op">=</span><span class="fu">list</span><span class="op">(</span>lambda<span class="op">=</span><span class="fu">mean</span><span class="op">(</span><span class="va">frog_counts</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-qq-rendered-qq-plot-pois-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This fit looks better. We can still argue whether a qq-plot is the
best representation for a Poisson fit, because due to the distribution’s
discreteness, many data points end up on the exact same spot in the plot
(overplotting). Thus, we loose information in this visualization.</p>
</section><section id="one-fits-all---fitdistrplus-package"><h2 class="section-heading">One fits all - <code>fitdistrplus</code> package<a class="anchor" aria-label="anchor" href="#one-fits-all---fitdistrplus-package"></a>
</h2>
<hr class="half-width">
<p>If you want a quick overview, you can use the
<code>fitdistrplus</code> package, which produces a series of plots.</p>
<p>Suppose you fit the frog counts to a normal distribution:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">fitdistrplus</span><span class="op">)</span></span>
<span><span class="va">my_fit</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">frog_counts</span>, dist <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span></span>
<span><span class="va">my_fit</span> <span class="co"># gives you the parameter estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Fitting of the distribution ' norm ' by maximum likelihood 
Parameters:
     estimate Std. Error
mean 3.830000  0.1495176
sd   2.114498  0.1057248</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">my_fit</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-qq-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>With some practice, this plot quickly allows you to see that you are
comparing discrete data to a continuous distribution. Also, the QQ-plot
doesn’t really give a straight line and the histogram seems to be skewed
to the left, compared to theory.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>What does it look like if you fit the <code>frog_counts</code> to a
Poisson instead?</p>
<p>Start from this set-up:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">51</span><span class="op">)</span> <span class="co"># set a seed for reproducibility</span></span>
<span><span class="va">frog_counts</span> <span class="op">&lt;-</span><span class="fu">rpois</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">fitdistrplus</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_fit</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">frog_counts</span>, dist <span class="op">=</span> <span class="st">"pois"</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">my_fit</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-qq-rendered-fitdistrplus-pois-solution-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-13-summary"><p>Content from <a href="13-summary.html">Summary</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/13-summary.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 5 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="section level3">
<h3 id="sampling-and-distributions">Sampling and distributions<a class="anchor" aria-label="anchor" href="#sampling-and-distributions"></a>
</h3>
<ul>
<li>In statistics, experiments are viewed as <strong>sampling</strong>
processes. Sampling means “drawing events” from a population of
interest. If the events are drawn randomly and independently, the
results are more likely to give a good representation of reality.<br>
</li>
<li>A <strong>probability distribution </strong> assigns probabilities
to the possible outcomes (in continuous distributions: to intervals of
outcomes).<br>
</li>
<li>
<strong>Discrete</strong> distributions give probabilities for
discrete outcomes, for example counts. For <strong>continuous</strong>
distributions, every value is assigned a <strong>density</strong>, and
probabilities can be calculated by integrating over the density in the
interval of interest.</li>
</ul>
</div>
<div class="section level3">
<h3 id="common-distributions-of-biological-data">Common distributions of biological data<a class="anchor" aria-label="anchor" href="#common-distributions-of-biological-data"></a>
</h3>
<ul>
<li>The <strong>binomial</strong> distribution models the number of
successes in a series of trials.<br>
</li>
<li>The <strong>Poisson</strong> distribution is often used for modeling
count data. It assumes that counts were over a fixed volume or period of
time. It is an approximation of the binomial distribution.<br>
</li>
<li>The <strong>negative binomial</strong> distribution is useful for
overdispersed count data, that is count data that are poorly fit by
Poisson, because they are not collected over fixed domains, or are
subject to some additional variation that isn’t captured by
Poisson.<br>
</li>
<li>The <strong>Gaussian</strong> or <strong>normal</strong>
distribution models repeated measurements of the same thing, and is a
continuous distribution. Many distributions (also discrete ones) can be
approximated by a Gaussian distribution for sufficiently large sample
sizes.</li>
</ul>
<p>Confused by what to approximate with what? Here is an overview:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/u9onO78hDlw" allowfullscreen>
</iframe>
</div>
<div class="section level3">
<h3 id="what-distribution-models-your-data-best">What distribution models your data best?<a class="anchor" aria-label="anchor" href="#what-distribution-models-your-data-best"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Fit your data</strong> to a distribution that you
consider plausible. The fit gives you the best parameters for this
distribution given your data.</p></li>
<li><p><strong>Visually compare</strong> the theory (i.e. the fitted
distribution) to your data points. A good fit doesn’t show systematic
deviations of the data points from theory.</p></li>
<li><p>Do the same with other plausible distributions.</p></li>
<li><p>Decide which of the fits looks best to you.</p></li>
</ol>
<p>Don’t be discouraged if step 4 isn’t always obvious! It just takes a
little practice. The following exercises are designed to build some
intuition on that.</p>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section><section id="aio-14-exercises"><p>Content from <a href="14-exercises.html">Exercises</a></p>
<hr>
<p> Last updated on 2023-11-21 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/14-exercises.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 90 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="exercises"><h2 class="section-heading">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<hr class="half-width">
<p>Here are some exercises for you to try yourself out in R, to practice
your knowledge on probability distributions, and to construct and
interpret meaningful visualizations.</p>
<p>Please feel encouraged to work in RStudio on your own computer for
this! This way, you will have an installation and some scripts ready
once you decide to work on your own data.</p>
<p>To install all packages necessary for completing the exercises and
running the examples in this tutorial, run the following command on your
computer:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">source</span><span class="op">(</span><span class="st">"https://www.huber.embl.de/users/kaspar/biostat_2021/install_packages_biostat.R"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="the-discoveries-data">The <code>discoveries</code> data<a class="anchor" aria-label="anchor" href="#the-discoveries-data"></a>
</h3>
<p>Consider the <code>discoveries</code> data. This data set is
contained in base R and has the number of “great inventions” for a
number of years. These are clearly count data.</p>
<ol style="list-style-type: decimal">
<li>Look up the example data using the R <code>help</code>
function.<br>
</li>
<li>Compare the fit to a Poisson with a fit to a negative binomial
(=gamma poisson) distribution.<br>
</li>
<li>Which of the two distribution do you think describe the data better?
And what could be a reason for that (remember what the data
describe)?<br>
</li>
<li>What could be problematic about fitting a Poisson or negative
binomial distribution to these data? Which assumption could be
violated?</li>
</ol>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">discov</span> <span class="op">&lt;-</span>  <span class="va">discoveries</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: grid</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="elisa-example">ELISA example<a class="anchor" aria-label="anchor" href="#elisa-example"></a>
</h3>
<p>This example is modified from <a href="https://www.huber.embl.de/msmb/Chap-Generative.html" class="external-link">chapter 1</a>
in MSMB by Susan Holmes and Wolfgang Huber.</p>
<p>When testing certain pharmaceutical compounds, it is important to
detect proteins that provoke an allergic reaction. The molecular sites
that are responsible for such reactions are called epitopes.</p>
<p>ELISA assays are used to detect specific epitopes at different
positions along a protein. The protein is tested at 100 different
positions, supposed to be independent. For each patient, this position
can either be a hit, or not. We’re going to study the data for 50
patients tallied at each of the 100 positions.</p>
<p>Start with the following lines:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epitope_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>position<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>                           count<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">7</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>In this data frame, the number of hits among the 50 patients is
counted at each position.</p>
<ol style="list-style-type: decimal">
<li>Plot the data in a meaningful way.<br>
</li>
<li>Fit the counts to a Poisson distribution. What is the fitted rate
parameter?<br>
</li>
<li>Does this look like a good fit?<br>
</li>
<li>ELISAs can give false positives at a certain rate. False positive
means declaring a hit – we think we have an epitope – when there is
none. Assume that most of the positions actually don’t contain an
epitope. In this case, you can consider the fitted Poisson model as the
“background noise” model, with lambda giving the expected number of
false positives. Given this model, what are the chances of seeing a
value as large as 7, if no epitope is present?</li>
</ol>
</div>
<div class="section level3">
<h3 id="mice-data">Mice data<a class="anchor" aria-label="anchor" href="#mice-data"></a>
</h3>
<p>Load the mice data:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mice_pheno</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file<span class="op">=</span> <span class="fu">url</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/mice_pheno.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<ol style="list-style-type: decimal">
<li>Plot a histogram, and a normal-QQ plot for female control mice.
Would you say the weights follow a normal distribution?</li>
<li>For comparing the control and high-fat group (for female mice), show
the ECDF of both in the same plot.</li>
</ol>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/carpentries/workbench-template-rmd/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:sarah.kaspar@embl.de">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="../LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.14.1" class="external-link">sandpaper (0.14.1)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.7.2" class="external-link">pegboard (0.7.2)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.3.3" class="external-link">varnish (0.3.3)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-rmd/instructor/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "statistics, biostatistics, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-rmd/instructor/aio.html",
  "identifier": "https://carpentries.github.io/workbench-template-rmd/instructor/aio.html",
  "dateCreated": "2023-09-08",
  "dateModified": "2023-11-21",
  "datePublished": "2023-11-21"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

